<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Risk Assessment — Non-weighted Questionnaire</title>

<!-- Chart.js (v4) -->
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

<style>
  :root{
    --bg:#f7fafc;
    --card:#ffffff;
    --muted:#6b7280;
    --accent1:#3b82f6;
    --accent2:#8b5cf6;
    --btn-grad: linear-gradient(135deg,var(--accent1),var(--accent2) 50%);
    --radius:12px;
  }
  *{box-sizing:border-box}
  body{margin:0;background:var(--bg);font-family:Inter,system-ui,Arial;color:#0b1220}
  .wrap{max-width:1050px;margin:28px auto;padding:18px}
  .card{background:var(--card);border-radius:var(--radius);padding:18px;box-shadow:0 12px 36px rgba(12,24,48,0.07)}
  h1{margin:0 0 6px;font-size:20px}
  .muted{color:var(--muted);font-size:13px;margin-bottom:12px}

  .columns{display:grid;grid-template-columns:1fr 420px;gap:20px;align-items:start}
  .section{margin-bottom:12px}
  label{display:block;font-weight:700;color:#374151;margin-bottom:6px;font-size:13px}
  input[type="number"], select, textarea{width:100%;padding:10px;border-radius:10px;border:1px solid #e6e8eb;background:#fff;font-size:14px}
  .row{display:flex;gap:10px}
  .small{width:120px;flex:0 0 120px}

  /* question grid */
  .qgrid{display:grid;grid-template-columns:repeat(2,1fr);gap:8px;margin-top:6px}
  .optionBtn{padding:10px 10px;border-radius:8px;border:1px solid #e6e8eb;background:#fff;cursor:pointer;text-align:left;font-size:14px}
  .optionBtn.active{border-color:transparent; box-shadow:0 8px 20px rgba(59,130,246,0.12); background: linear-gradient(180deg,#f8fbff,#ffffff)}

  .btn{display:inline-block;padding:12px 16px;border-radius:12px;border:0;color:white;font-weight:800;background:var(--btn-grad);cursor:pointer;box-shadow:0 10px 28px rgba(59,130,246,0.14)}
  .secondary{background:#eef2ff;color:#0b1220;border:0;padding:10px 12px;border-radius:10px;cursor:pointer}

  /* result card */
  .resultBox{background:linear-gradient(180deg,#fff,#fbfdff);border-radius:10px;padding:12px;margin-bottom:8px;box-shadow:0 8px 18px rgba(12,24,48,0.04)}
  .profile{font-size:18px;font-weight:800}
  .score{font-size:28px;font-weight:900;color:#14908b}
  .smallMuted{font-size:13px;color:var(--muted)}

  /* chart */
  .chartWrap{display:flex;flex-direction:column;align-items:center}
  .donut{width:260px;height:260px;position:relative}
  canvas{width:100% !important;height:100% !important;display:block}
  .centerText{position:absolute;left:0;top:0;width:100%;height:100%;display:flex;flex-direction:column;align-items:center;justify-content:center;pointer-events:none}
  .centerText .profileSmall{font-weight:800}
  .centerText .label{font-size:13px;color:var(--muted);margin-top:6px}

  .allocList{margin-top:10px}
  .allocRow{display:flex;justify-content:space-between;padding:8px 0;border-top:1px solid #f3f4f6}

  .breakdown{margin-top:12px;background:#fff;border-radius:10px;padding:10px;box-shadow:0 6px 14px rgba(12,24,48,0.03)}
  .breakRow{display:flex;justify-content:space-between;padding:6px 0;font-size:13px;color:#374151;border-bottom:1px dashed #f3f4f6}
  .breakRow small{color:var(--muted);font-size:12px}

  @media (max-width:980px){
    .columns{grid-template-columns:1fr}
    .small{flex:1}
    .donut{width:220px;height:220px}
  }
</style>
</head>
<body>
  <div class="wrap">
    <div class="card" role="main" aria-label="Risk Assessment Calculator (non-weighted)">
      <h1>Risk Assessment Calculator </h1>
      <div </div>

      <div class="columns">
        <!-- LEFT: inputs & questions -->
        <div>
          <div class="section">
            <label for="age">Age</label>
            <input id="age" type="number" min="18" max="100" value="35" />
          </div>

          <div class="section">
            <label for="amount">Investable amount (₹)</label>
            <input id="amount" type="number" min="0" value="200000" />
          </div>

          <div class="section">
            <label for="horizon">Investment horizon</label>
            <select id="horizon">
              <option value="1">Under 1 year</option>
              <option value="3">1-3 years</option>
              <option value="5">3-5 years</option>
              <option value="10">5-10 years</option>
              <option value="15" selected>10+ years</option>
            </select>
          </div>

          <!-- 8 questions - each option maps to a numeric value (0..5) -->
          <div class="section">
            <label>1) If your portfolio drops 20% in a year, what would you do?</label>
            <div class="qgrid" data-q="q1">
              <button class="optionBtn" data-val="0">Sell everything</button>
              <button class="optionBtn" data-val="1">Sell some</button>
              <button class="optionBtn" data-val="3">Hold</button>
              <button class="optionBtn" data-val="5">Buy more</button>
            </div>
          </div>

          <div class="section">
            <label>2) What is your primary financial goal?</label>
            <div class="qgrid" data-q="q2">
              <button class="optionBtn" data-val="0">Capital preservation</button>
              <button class="optionBtn" data-val="2">Income</button>
              <button class="optionBtn" data-val="4">Wealth growth</button>
              <button class="optionBtn" data-val="5">Aggressive growth</button>
            </div>
          </div>

          <div class="section">
            <label>3) Investment experience</label>
            <div class="qgrid" data-q="q3">
              <button class="optionBtn" data-val="0">None</button>
              <button class="optionBtn" data-val="2">Limited</button>
              <button class="optionBtn" data-val="4">Moderate</button>
              <button class="optionBtn" data-val="5">Extensive</button>
            </div>
          </div>

          <div class="section">
            <label>4) Time horizon tolerance — how long can you stay invested?</label>
            <div class="qgrid" data-q="q4">
              <button class="optionBtn" data-val="0">&lt;1 year</button>
              <button class="optionBtn" data-val="2">1-3 years</button>
              <button class="optionBtn" data-val="3">3-5 years</button>
              <button class="optionBtn" data-val="5">5+ years</button>
            </div>
          </div>

          <div class="section">
            <label>5) Reaction to volatility — you prefer:</label>
            <div class="qgrid" data-q="q5">
              <button class="optionBtn" data-val="0">Low volatility, low returns</button>
              <button class="optionBtn" data-val="2">Balanced risk/return</button>
              <button class="optionBtn" data-val="4">Higher risk for higher returns</button>
              <button class="optionBtn" data-val="5">Maximum return despite swings</button>
            </div>
          </div>

          <div class="section">
            <label>6) Liquidity needs</label>
            <div class="qgrid" data-q="q6">
              <button class="optionBtn" data-val="0">Need funds soon</button>
              <button class="optionBtn" data-val="2">Possible short-term needs</button>
              <button class="optionBtn" data-val="4">Long-term, no urgent needs</button>
              <button class="optionBtn" data-val="5">Very long-term</button>
            </div>
          </div>

          <div class="section">
            <label>7) Loss tolerance — maximum single-year loss you'd tolerate?</label>
            <div class="qgrid" data-q="q7">
              <button class="optionBtn" data-val="0">Up to 5%</button>
              <button class="optionBtn" data-val="2">Up to 10%</button>
              <button class="optionBtn" data-val="4">Up to 20%</button>
              <button class="optionBtn" data-val="5">30%+</button>
            </div>
          </div>

          <div class="section">
            <label>8) How important is outperformance vs stability?</label>
            <div class="qgrid" data-q="q8">
              <button class="optionBtn" data-val="0">Stability only</button>
              <button class="optionBtn" data-val="2">Some outperformance</button>
              <button class="optionBtn" data-val="4">Growth-focused</button>
              <button class="optionBtn" data-val="5">Outperformance is top priority</button>
            </div>
          </div>

          <div style="display:flex;gap:10px;align-items:center;margin-top:8px">
            <button id="calculateBtn" class="btn">Calculate</button>
            <button id="resetBtn" class="secondary">Reset</button>
          </div>
        </div>

        <!-- RIGHT: results & donut -->
        <div>
          <div class="resultBox" role="status" aria-live="polite">
            <div style="display:flex;justify-content:space-between;align-items:center">
              <div>
                <div class="smallMuted">Risk score</div>
                <div class="score" id="scoreVal">—</div>
              </div>
              <div style="text-align:right">
                <div class="profile" id="profileLabel">—</div>
                <div id="profileDesc" class="smallMuted" style="max-width:220px"></div>
              </div>
            </div>
          </div>

          <div class="chartWrap" style="margin-top:10px">
            <div class="donut" aria-hidden="true">
              <canvas id="allocDonut" width="400" height="400"></canvas>
              <div class="centerText">
                <div class="profileSmall" id="centerProfile">—</div>
                <div class="label">allocation</div>
              </div>
            </div>

            <div class="allocList">
              <div class="allocRow"><div>Stocks</div><div id="allocStocks">—</div></div>
              <div class="allocRow"><div>Bonds</div><div id="allocBonds">—</div></div>
              <div class="allocRow"><div>Cash</div><div id="allocCash">—</div></div>
            </div>
          </div>

          <div class="breakdown" style="margin-top:12px">
            <div style="font-weight:700;margin-bottom:8px">Score breakdown</div>
            <div class="breakRow"><div><small>Age factor</small></div><div id="breakAge">—</div></div>
            <div class="breakRow"><div><small>Horizon factor</small></div><div id="breakHorizon">—</div></div>
            <div class="breakRow"><div><small>Qs (total)</small></div><div id="breakQs">—</div></div>
            <div class="breakRow" style="border-bottom:0;"><div><small>Total</small></div><div id="breakTotal">—</div></div>
          </div>

          <div style="margin-top:12px">
            <div style="font-weight:700;margin-bottom:6px">Recommendation</div>
            <div id="recommendation" style="color:#374151;font-size:14px">—</div>
          </div>
        </div>
      </div>
    </div>
  </div>

<script>
/* ===== Helpers ===== */
const clamp = (v, a, b) => Math.max(a, Math.min(b, v));
const pct = v => Math.round(v) + '%';

/* read option for grid */
function readOption(gridName){
  const grid = document.querySelector(`[data-q="${gridName}"]`);
  if (!grid) return null;
  const btn = grid.querySelector('.optionBtn.active');
  return btn ? Number(btn.dataset.val) : null;
}

/* handle option clicks */
document.querySelectorAll('.qgrid').forEach(g => {
  g.addEventListener('click', (e) => {
    const btn = e.target.closest('.optionBtn');
    if (!btn) return;
    g.querySelectorAll('.optionBtn').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
  });
});

/* ===== Chart setup (donut) ===== */
const ctx = document.getElementById('allocDonut').getContext('2d');
const donut = new Chart(ctx, {
  type: 'doughnut',
  data: {
    labels: ['Stocks','Bonds','Cash'],
    datasets: [{
      data: [60,30,10],
      backgroundColor: ['#bbb','#666','#222'],
      borderWidth: 0,
      cutout: '60%',
      rotation: -0.25 * Math.PI,
      hoverOffset: 8
    }]
  },
  options: {
    maintainAspectRatio: false,
    plugins: {
      legend: { display: false },
      tooltip: { callbacks: { label: (c) => `${c.label}: ${c.raw}%` } }
    }
  }
});

/* black-gray vertical gradients for donut slices */
function applyBlackGreyGradients(){
  const c = document.getElementById('allocDonut');
  const h = c.height || 400;
  const g1 = ctx.createLinearGradient(0,0,0,h); g1.addColorStop(0,'#bdbdbd'); g1.addColorStop(1,'#8e8e8e');
  const g2 = ctx.createLinearGradient(0,0,0,h); g2.addColorStop(0,'#8a8a8a'); g2.addColorStop(1,'#4c4c4c');
  const g3 = ctx.createLinearGradient(0,0,0,h); g3.addColorStop(0,'#333333'); g3.addColorStop(1,'#0b0b0b');
  donut.data.datasets[0].backgroundColor = [g1,g2,g3];
  donut.update();
}

/* ===== Scoring (non-weighted) =====
   - Age factor (0..25)
   - Horizon factor (0..25)
   - Questions: sum of 8 q values (each 0..5) => max 40 -> mapped to 0..50
   Total scale 0..100
*/
function computeScoreNonWeighted(){
  // age factor: younger -> higher
  const age = Number(document.getElementById('age').value) || 35;
  const ageRaw = clamp((65 - age) / (65 - 18), 0, 1);
  const ageFactor = Math.round(ageRaw * 25);

  // horizon factor: longer horizon -> higher (0..25)
  const horizon = Number(document.getElementById('horizon').value) || 5;
  const horizonRaw = clamp((Math.log(horizon + 1) / Math.log(16)), 0, 1);
  const horizonFactor = Math.round(horizonRaw * 25);

  // questions (equal weight)
  let qSum = 0;
  for (let i = 1; i <= 8; i++){
    const val = readOption('q' + i);
    if (val === null) return { err: `Please answer question ${i}` };
    qSum += val;
  }
  // qSum range 0..40 -> map to 0..50
  const qFactor = Math.round((qSum / (5 * 8)) * 50);

  const rawTotal = ageFactor + horizonFactor + qFactor;
  const score = Math.round(clamp(rawTotal, 0, 100));
  return { score, ageFactor, horizonFactor, qFactor, qSum };
}

/* Map score to profile & allocation */
function profileForScore(score){
  if (score < 30) return { id:'Conservative', desc: 'Capital preservation; low equity exposure.', alloc:{stocks:20,bonds:60,cash:20} };
  if (score < 50) return { id:'Moderate', desc: 'Balanced growth with income focus.', alloc:{stocks:40,bonds:45,cash:15} };
  if (score < 70) return { id:'Growth', desc: 'Growth-oriented; higher equity exposure.', alloc:{stocks:60,bonds:30,cash:10} };
  return { id:'Aggressive', desc: 'High growth appetite; mostly equities.', alloc:{stocks:80,bonds:15,cash:5} };
}

/* Build recommendation text */
function buildRecommendation(profile){
  let text = `${profile.desc} Suggested allocation — Stocks ${profile.alloc.stocks}%, Bonds ${profile.alloc.bonds}%, Cash ${profile.alloc.cash}%.`;
  if (profile.id === 'Conservative') text += ' Consider high-quality bonds, liquid funds and short-duration instruments.';
  if (profile.id === 'Moderate') text += ' Consider balanced funds, large-cap equities and bond ladders.';
  if (profile.id === 'Growth') text += ' Prefer equity funds with systematic investing and periodic rebalancing.';
  if (profile.id === 'Aggressive') text += ' Use long-term equity strategies and accept short-term volatility.';
  text += ' Review and rebalance annually or when life changes.';
  return text;
}

/* Update UI from computed score */
function updateUI(){
  const res = computeScoreNonWeighted();
  if (res.err){ alert(res.err); return; }
  const score = res.score;
  document.getElementById('scoreVal').textContent = score;
  const prof = profileForScore(score);
  document.getElementById('profileLabel').textContent = prof.id;
  document.getElementById('profileDesc').textContent = prof.desc;
  document.getElementById('centerProfile').textContent = prof.id;

  document.getElementById('allocStocks').textContent = prof.alloc.stocks + '%';
  document.getElementById('allocBonds').textContent = prof.alloc.bonds + '%';
  document.getElementById('allocCash').textContent = prof.alloc.cash + '%';

  // update donut values (percentages)
  donut.data.datasets[0].data = [prof.alloc.stocks, prof.alloc.bonds, prof.alloc.cash];
  applyBlackGreyGradients();

  // breakdown
  document.getElementById('breakAge').textContent = res.ageFactor;
  document.getElementById('breakHorizon').textContent = res.horizonFactor;
  document.getElementById('breakQs').textContent = res.qFactor + ` (raw ${res.qSum})`;
  document.getElementById('breakTotal').textContent = res.score;

  // recommendation text
  document.getElementById('recommendation').textContent = buildRecommendation(prof);
}

/* event wiring */
document.getElementById('calculateBtn').addEventListener('click', updateUI);
document.getElementById('resetBtn').addEventListener('click', () => {
  // reset inputs
  document.getElementById('age').value = 35;
  document.getElementById('amount').value = 200000;
  document.getElementById('horizon').value = 15;
  // reset choices: pick middle option
  document.querySelectorAll('.qgrid').forEach((g)=>{
    g.querySelectorAll('.optionBtn').forEach(b => b.classList.remove('active'));
    const opts = g.querySelectorAll('.optionBtn');
    if (opts.length) opts[Math.floor(opts.length/2)].classList.add('active');
  });
  updateUI();
});

/* set sensible default active options and initialize */
(function init(){
  document.querySelectorAll('.qgrid').forEach((g)=>{
    const opts = g.querySelectorAll('.optionBtn');
    if (opts.length) opts[Math.floor(opts.length/2)].classList.add('active');
  });
  applyBlackGreyGradients();
  updateUI();
})();
</script>
</body>
</html>
